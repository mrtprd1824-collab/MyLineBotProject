<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Admin - Chat Log</title>
    <style>
        body { font-family: sans-serif; margin: 2em; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top;}
        th { background-color: #f2f2f2; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .reply-form { display: flex; }
        .reply-form input[type="text"] { flex-grow: 1; margin-right: 5px; }
        .header-actions { margin-bottom: 1em; }
    </style>
</head>
<body>
    <div class="header-actions">
        <span>Logged in as: <strong>{{ current_user.username }}</strong></span>
        <a href="{{ url_for('logout') }}">Logout</a>
    </div>

    <h1>üìñ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å LINE OA</h1>
    <table>
        <thead>
            <tr>
                <th style="width:150px;">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á</th>
                <th style="width:250px;">User ID</th>
                <th>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</th>
                <th style="width:250px;">‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö</th>
            </tr>
        </thead>
        <tbody>
            {% for message in messages %}
            <tr>
                <td>{{ message.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td>{{ message.user_id }}</td>
                <td>{{ message.message_text }}</td>
                <td>
                    <form class="reply-form" action="{{ url_for('send_reply') }}" method="post">
                        <input type="hidden" name="user_id" value="{{ message.user_id }}">
                        <input type="text" name="reply_message" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö..." required>
                        <button type="submit">‡∏™‡πà‡∏á</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>